
# Встреча №1 - Ревью

## Нужно добавить и продумать

- [ ] Сервис `Subscription service` (для реализации SAGA Choreography на сценарие подписки) -> на развите, Переписываем на Orchestration и делаем SubscriptionWorkflowManager
- [ ] Сервис нотификации `Notification Service` на почту для подтверждения регистрации, отправки писем о покупке подписки, отмене подписки.
- [ ] Сервис `Auth Service` для авторизации, аутентификации и управления токенами
- [ ] Внешний OAuth Provider (Google/VK/Yandex...)
- [ ] для сервиса Каталогов подумать про SQRS
- [ ] CDP для Эластика и Постгресс чтобы их засинкать
- [ ] Выбор CDN (сервис)
- [ ] Собственный CDN вместо Яндекса чтобы экономить деньги на услуге (выбирать сервер, выбирать оптимальный по расстоянию и загрузке)
- [ ] Доставка контента на CDN

### Сервис `Subscription service`

**SAGA Choreography на сценарие подписки**

- Payment Service → событие PaymentCompleted (или PaymentFailed)
- Subscription Service → ловит PaymentCompleted, обновляет базу, дергает Auth Service, публикует SubscriptionActivated.
- Notification Service → ловит SubscriptionActivated, шлет уведомление.
- Ads Service → ловит SubscriptionActivated или просто видит обновленный JWT.

Компенсация (если упал любой шаг):

- PaymentFailed → просто отмена процесса.
- Если упал Subscription Service — генерируется событие SubscriptionFailed, Payment Service ловит его и делает возврат.


## Почитать изучить

- [x] Почитать про OAuth20 - например через гугл, как работает вся цепочка, как получать инфо для профиля и т д
- [ ] SQRS (изучить примеры и какие правила)
- [ ] Теорема САР для Постгрес и для Эластик (у кого какие пункты по теореме)
- [ ] Про CDP - что это и как реализовать для Эластик и\или Постгрес
- [ ] Выбор CDN сервера, на бэкенде или клиенте? мб новый сервер? 
- [ ] Почитать про Пинг и как его использовать в поиске для анализа загрузки сервера
- [ ] Как доставлять контент на CDN (сначала они пустые)
- [ ] Рекурентный платеж
- [x] Паттерн САГА спрятан (Изучить на этом примере и другом)

## На подумать и добавить или нет в архитектуру

- Подумать про микросервис Events для сбора статистики прослушивания клиента (отдельный сервис, в отдельном месте и сревере, хранилище)
- Clickhouse для большого объема статистики данных стукрутрированных (нужно протестить и проверить что это реально лучше Postgres)
- Подобные задачи как рекомендации, генерации ленты и т д это дорогие операции их надо отложенно выполнять, и выдавать резульатат. КАК?

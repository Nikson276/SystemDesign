

## Архитектура

Разделить все на домены согласно паттерну разбиения на микросервисы "По поддоменам" с концепцией Domain-Driven Design, DDD. 

- Админка → S3 → NOSQL для МЕТА → БД Postgres для связей → Kakfa для заданий на загрузку отложенных
- Каталог → Elasticsearch + Postges → Микросервис поиска треков, создания плейлистов
- Плеер → Микросервис с CDN и всеми функциями плеера (потоковая загрузка из S3, управление, качество)
- Пользователи, авторизация и подписки → Postgres, Reddis, Микросервис аутентификации и оплаты
- Реклама и монетизация → Тут не знаю по стеку, Микросервис, БД по необходимости или использовать общую



Архитектура «Тунец» (v1): 

- Domain-Driven Design: микросервисы по бизнес-доменам — Ingestion, Catalog, Playback, Users, Payments, Ads, Recommendations.
- Event-Driven: Kafka как центральный backbone; события `TrackPublished` генерируются приложением (Application-Managed Events), не через CDC.
- Storage-aware:
  - PostgreSQL — источник истины для структурированных данных,
  - Elasticsearch — read-оптимизированный индекс для поиска
  - S3 — хранение аудиофайлов,
  - Redis — кэширование сессий, флагов `is_premium`, rate limiting.
- API-first:
  - API Gateway управляет всеми входящими запросами, JWT содержит `is_premium` → плеер принимает решение о рекламе локально.
- Observability: сквозная трассировка (trace ID от админки до CDN).
- Админка: UI + BFF, клиент Ingestion-сервиса, не отдельный домен.

